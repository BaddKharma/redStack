# terraform.tfvars.example
# Copy this to terraform.tfvars and fill in your values

# ============================================================================
# REQUIRED VARIABLES - YOU MUST SET THESE
# ============================================================================

# Your public IP for SSH access (find with: curl ifconfig.me)
# Must be in CIDR format with /32 suffix
localPub_ip = "1.2.3.4/32"

# Name of your existing AWS SSH key pair
# Must already exist in AWS EC2 Console > Key Pairs
ssh_key_name = "rs-rsa-key"

# Path to your SSH private key (.pem file) — used to decrypt the Windows Administrator password
ssh_private_key_path = "./rs-rsa-key.pem"

# Your redirector domain — apex or subdomain (e.g. c2.yourdomain.com)
# Point this domain's A record to the Redirector Elastic IP after deployment
redirector_domain = "c2.example.com"

# ============================================================================
# OPTIONAL VARIABLES - Customize as needed
# ============================================================================

# AWS region for deployment
aws_region = "us-east-1"

# Project name (used for resource tagging)
project_name = "redStack"

# Instance types (adjust based on budget/performance needs)
mythic_instance_type     = "t3.medium"  # 2 vCPU, 4GB RAM
guacamole_instance_type  = "t3.small"   # 2 vCPU, 2GB RAM
windows_instance_type    = "t3.medium"  # 2 vCPU, 4GB RAM
sliver_instance_type     = "t3.small"   # 2 vCPU, 2GB RAM
havoc_instance_type      = "t3.medium"  # 2 vCPU, 4GB RAM
redirector_instance_type = "t3.micro"   # 1 vCPU, 1GB RAM

# Network configuration
use_default_vpc = true    # Set to false to create a dedicated VPC
# vpc_cidr = "10.50.0.0/16"  # Only used if use_default_vpc = false

# Mythic configuration
enable_mythic_autostart = true  # Auto-start Mythic on boot

# C2 URI prefixes (CDN/cloud-style paths routed through the redirector)
# These are baked into payloads at deploy time. Customize before deploying.
mythic_uri_prefix = "/cdn/media/stream"
sliver_uri_prefix = "/cloud/storage/objects"
havoc_uri_prefix  = "/edge/cache/assets"

# C2 header validation is always enabled. These override the defaults:
# c2_header_name  = "X-Request-ID"  # Header name (default: X-Request-ID)
# c2_header_value = ""              # Token value — leave empty to auto-generate (recommended)

# --- CTF/Pro Lab mode (HTB/THM/VulnLabs/ProvingGrounds via OpenVPN) ---
# Default is open-environment (public domain + htaccess on). Only change these for CTF/Pro Lab use.
enable_external_vpn                  = false  # Set to true for HTB/THM/VulnLabs/PG — enables OpenVPN client + VPC routing (see Part 8)
enable_redirector_htaccess_filtering = true   # Set to false for HTB/THM/VulnLabs/PG — scanner/AV blocking not needed in lab environments
# external_vpn_cidrs = ["10.10.0.0/16"]  # CIDR blocks reachable through the VPN tunnel (default covers most HTB/THM/VulnLabs ranges)

# WireGuard keys — required when enable_external_vpn = true
# Guacamole acts as WireGuard client/gateway in the default VPC, tunneling to the redirector.
# Generate on any Linux/WSL machine:
#   wg genkey | tee /tmp/wg-server.key | wg pubkey > /tmp/wg-server.pub
#   wg genkey | tee /tmp/wg-client.key | wg pubkey > /tmp/wg-client.pub
# wg_server_private_key = ""   # redirector (server) private key
# wg_server_public_key  = ""   # redirector (server) public key
# wg_client_private_key = ""   # guacamole (client) private key
# wg_client_public_key  = ""   # guacamole (client) public key

# Optional: Custom tags applied to every AWS resource (instances, SGs, EIPs, etc.)
# Useful for cost tracking, filtering resources in the AWS Console, and billing reports
tags = {
  Owner      = "Operator"
  CostCenter = "redStack"
  Purpose    = "Boot-to-Breach Training Environment"
}

# ============================================================================
# NOTES
# ============================================================================
#
# 1. To get your public IP:
#    curl ifconfig.me
#    Then append /32 for CIDR format
#
# 2. To create an SSH key pair in AWS:
#    AWS Console > EC2 > Key Pairs > Create key pair
#    OR via CLI: aws ec2 create-key-pair --key-name rs-rsa-key --query 'KeyMaterial' --output text > ./rs-rsa-key.pem
#    Then: chmod 400 ./rs-rsa-key.pem
#
# 3. Estimated monthly cost (all instances running 24/7):
#    - t3.medium (3x): ~$90/month
#    - t3.small  (2x): ~$30/month
#    - t3.micro  (1x): ~$7.50/month
#    Total: ~$127.50/month + data transfer
#
# 4. To reduce costs:
#    - Stop instances when not in use
#    - Use smaller instance types for demo/short labs
#    - Destroy infrastructure when done with: terraform destroy
#
